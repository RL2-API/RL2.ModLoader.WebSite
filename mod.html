<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title></title>
	<link rel="stylesheet" href="styles/mods.css">
	<link rel="stylesheet" href="styles/common.css">
	<link rel="stylesheet" href="styles/links.css">
</head>
<body class="background base-layout">

<!-- Navbar -->
<nav class="navbar">
	|
	<div class="navbar-element">
		<a href="https://github.com/RL2-API/RL2.ModLoader/releases/latest" class="link">
			<h2>Download</h2>
		</a>
	</div>
	|
	<div class="navbar-element">
		<img src="https://raw.githubusercontent.com/RL2-API/RL2.ModLoader/main/Assets/ModLoaderIcon-NoText-700x700.png" width="50"/>
		&ensp;&ensp;
		<a href="/" class="link">
			<h2>RL2.ModLoader</h2>
		</a>
	</div>
	|
	<div class="navbar-element">
		<a href="/mods/" class="link">
			<h2>Mods</h2>
		</a>
	</div>
	|
</nav>

<div id="mod-info"></div>

</body>
</html>

<script type="module">

// SolidJS
import { createResource, For } from "https://esm.sh/solid-js@1.8.1";
import { render } from "https://esm.sh/solid-js@1.8.1/web";
import h from "https://esm.sh/solid-js@1.8.1/h";
import html from "https://esm.sh/solid-js@1.8.1/html";
// Database
import { createClient } from "https://esm.sh/@libsql/client"

const db = createClient({
	url: "https://rl2-mod-store-tacoconkvass.aws-eu-west-3.turso.io",
  authToken: "eyJhbGciOiJFZERTQSIsInR5cCI6IkpXVCJ9.eyJhIjoicm8iLCJpYXQiOjE3MzI4ODk5NjcsImlkIjoiOTJiYmNjYmMtZDU1Yy00MWNkLTkxMmEtNTM1MjU1Yzk1OGZmIn0.oQs2JAoq6lCJuyIPQglcIBvjJtCbx2cDxinvhJIVcqOzst6kesnX95zz9ZL46-UTfrNKazpv1s6dOfTYew0JAg",
})

const searchParams = new URLSearchParams(window.location.search);

const ModList = () => {
	const [data] = createResource(
		async () => {
			const result = await db.execute("SELECT longinfo.name, longinfo.description, shortinfo.version FROM longinfo INNER JOIN shortinfo ON longinfo.name = shortinfo.name WHERE longinfo.name LIKE " + "\"" + searchParams.get('name') + "\"");
			return result.rows;
		}
	);

	return html`
		<div innerHTML=${() => {
			const bonk = data();
			if (bonk) {
				return bonk[0].description;
			}
			else {
				return "<h3 class=\"loading\">Loading...</h3>";
			}
		}}></div>
	`;
};
	
render(ModList, document.getElementById("mod-info"));

</script>
